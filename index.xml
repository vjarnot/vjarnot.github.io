<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Zeroth Oughts</title><link>https://vjarnot.github.io/</link><description>Recent content on Zeroth Oughts</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Sun, 12 Feb 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://vjarnot.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>Supermicro AOC-S3008L-L8E + Noctua NF-A4x20</title><link>https://vjarnot.github.io/posts/2023-02-12-supermicro-lsi-hba-plus-noctua/</link><pubDate>Sun, 12 Feb 2023 00:00:00 +0000</pubDate><guid>https://vjarnot.github.io/posts/2023-02-12-supermicro-lsi-hba-plus-noctua/</guid><description>LSI-based HBAs are designed for the airflow of a servier chassis, not a repurposed desktop PC. They run hot, and - in my opinion - should get a little cooling assistance.</description><content:encoded><![CDATA[<h2 id="supermicro-lsi-hba-fan-addition">Supermicro LSI HBA Fan Addition</h2>
<p>When I initially <a href="https://vjarnot.github.io/posts/2023-02-11-lsi-firmware-flashing/">installed my eBay-acquired HBA to flash its firmware</a>
,
I noticed after a bit that the heatsink was <em>very</em> hot to the touch.
My infrared thermometer read the heatsink at over 135° F, so the heatsink was approaching 60° C; the chip will be - obviously - hotter than the heatsink.
<strong>This was at idle with no disks plugged in.</strong> I&rsquo;ve read that these LSI chips would ultimately prefer a life at or below 55° C, so I&rsquo;ve added a fan to my HBA.</p>
<p>I got started with Noctua fans back in the bad-old-days when computer fans were generally garbage with a few exceptions. These days, they&rsquo;re generally decent
with a few exceptions, but inertia is a helluva drug, so I used the <a href="https://amzn.to/3If9J1I" target="_blank" rel="noopener">NF-A4x20 PWM</a>
.</p>
<p>I&rsquo;ve seen 3D-printed mounts, I&rsquo;ve seen screws - both into the heatsink and through the heatsink, and I&rsquo;ve seen zipties.
I don&rsquo;t think I&rsquo;ve seen someone do their zipties as I have - around the heatsink, not the HBA, so I thought I&rsquo;d throw up some pictures in case it helps anyone.</p>
<p><img loading="lazy" src="/images/supermicro-hba-noctua-1.jpg" type="" alt="Supermicro AOC-S3008L-L8E &#43; Noctua NF-A4x20"  /></p>
<p><img loading="lazy" src="/images/supermicro-hba-noctua-2.jpg" type="" alt="Supermicro AOC-S3008L-L8E &#43; Noctua NF-A4x20"  /></p>
<p><img loading="lazy" src="/images/supermicro-hba-noctua-3.jpg" type="" alt="Supermicro AOC-S3008L-L8E &#43; Noctua NF-A4x20"  /></p>
]]></content:encoded></item><item><title>LSI HBA Flashing</title><link>https://vjarnot.github.io/posts/2023-02-11-lsi-firmware-flashing/</link><pubDate>Sat, 11 Feb 2023 00:00:00 +0000</pubDate><guid>https://vjarnot.github.io/posts/2023-02-11-lsi-firmware-flashing/</guid><description>I recently acquired an LSI 9300-8i Supermicro HBA and needed to flash the firmware for use with TrueNAS... the process was more of a hassle than I&amp;#39;d expected.</description><content:encoded><![CDATA[<h2 id="lsi-hba-it-mode-firmware-flashing">LSI HBA IT-mode Firmware Flashing</h2>
<p>Oh, what fun we&rsquo;ll have: Flashing an IT-mode firmware to an LSI 9300-8i Supermicro HBA on a UEFI system.</p>
<p>You&rsquo;re likely here because - like me - you&rsquo;re struggling to either figure out how to flash your HBA,
or how to get your relatively-recent desktop PC to actually boot FreeDOS and work (spoiler: I don&rsquo;t go down the FreeDOS route here).</p>
<p>If you want a real guide, read this: <a href="https://www.truenas.com/community/resources/detailed-newcomers-guide-to-crossflashing-lsi-9211-9300-9305-9311-9400-94xx-hba-and-variants.54/" target="_blank" rel="noopener">https://www.truenas.com/community/resources/detailed-newcomers-guide-to-crossflashing-lsi-9211-9300-9305-9311-9400-94xx-hba-and-variants.54/</a>
</p>
<p><strong>If my rambling doesn&rsquo;t interest you, <a href="#tldr-lets-flash">skip down to the good stuff</a>
</strong></p>
<h2 id="background">Background</h2>
<p>Currently the media and other bulk-storage needs of our household are handled by an Intel Rapid Storage RAID 5 array of 4x 3TB disks sitting in my desktop PC.
This arrangement may sound impressive if your concept of bulk storage is limited to finding yet another cheap external hard drive to plug in,
but is laughable to the NAS-enthusiast community.</p>
<p>Given that it&rsquo;s time for a new PC for myself, I got to thinking about acquiring a &lsquo;proper&rsquo; consumer-grade NAS to untether my day-to-day computer from its
NAS-ish duties. As tends to happen, the rabbit-hole of research led to me learn a bit about Synology and its competitors, work out a game-plan, get an Amazon
shopping cart populated and ready to go, and completely change my mind and reverse course.</p>
<p>Enter the new plan: build myself a new PC, repurpose current PC to serve as a NAS. Enter TrueNAS: <a href="https://www.truenas.com/truenas-scale/" target="_blank" rel="noopener">https://www.truenas.com/truenas-scale/</a>
</p>
<h2 id="so-what">So what?</h2>
<p>So the recommended approaches for TrueNAS are</p>
<ul>
<li>Buy a box from iXsystems</li>
<li>Buy a server on eBay, modify as/if needed, and install TrueNAS</li>
</ul>
<p>Those don&rsquo;t meet my goal of repurposing my existing desktop PC, so I&rsquo;ll be going with the <strong>not</strong>-particularly-recommended route of:</p>
<ul>
<li>Do what you can to a PC to make it TrueNAS-viable <em>(for home use, if you&rsquo;re doing this professionally, close this browser tab immediately)</em>.</li>
</ul>
<p>So under the guise of doing what&rsquo;s reasonable to make this not suck, I&rsquo;ll be reusing the PC, but hooking up new HDDs to a Host Bus Adapater (HBA) rather
than directly to the SATA ports of my motherboard.</p>
<h2 id="so-why-are-we-flashing-firmware">So why are we flashing firmware?</h2>
<p>The canonically-recommended HBAs for TrueNAS are those that utilize LSI chips. A ton of different manufacturers have made HBAs with these chips.
Within that plethora, there&rsquo;s the 92xx series, the 93xx series, and others - this is definitely <em>not</em> the place to learn all about LSI HBAs.</p>
<p>I&rsquo;ll be using a Supermicro card with a 9300-8i chip on it, because that&rsquo;s the one I got on eBay. If you&rsquo;re heading down this path, do your research
and confirm that the card you&rsquo;re buying has the chip you want (and you want that chip because you read enough on the TrueNAS forums to know it&rsquo;ll work).</p>
<h3 id="but-seriously-why">But seriously, why?</h3>
<p>This is over-simplified to a probably-dangerous point, but here goes:</p>
<p>HBAs operate in one of two (that we&rsquo;re concerned with) modes:</p>
<ul>
<li>IR: RAID mode <strong>[no bueno]</strong></li>
<li>IT: not RAID mode <strong>[yes bueno]</strong></li>
</ul>
<p>For use with TrueNAS, your HBA <em><strong>absolutely must</strong></em> be in IT mode - and this is set via the firmware that your HBA is running. So - we need to flash
the IT mode firmware to our HBA.</p>
<p>Also, there&rsquo;s this: <a href="https://www.truenas.com/community/resources/lsi-9300-xx-firmware-update.145/" target="_blank" rel="noopener">https://www.truenas.com/community/resources/lsi-9300-xx-firmware-update.145/</a>
.
Specifically for the LSI 9300 series, IT mode is not enough, it needs to be IT mode using the specific firmware version available for download at that link.</p>
<h2 id="flashing">Flashing</h2>
<h3 id="overview">Overview</h3>
<p>We need four things: the HBA (installed), the firmware file, the software to flash the firmware to the card, and a USB stick.
We&rsquo;ve covered the first two, regarding the third: you&rsquo;re going to want sas<strong>2</strong>flash for 92xx cards, and sas<strong>3</strong>flash for 93xx cards.</p>
<p><a href="https://www.broadcom.com/support/knowledgebase/1211161501344/flashing-firmware-and-bios-on-lsi-sas-hbas" target="_blank" rel="noopener">https://www.broadcom.com/support/knowledgebase/1211161501344/flashing-firmware-and-bios-on-lsi-sas-hbas</a>
</p>
<h3 id="tldr-lets-flash">TL;DR: Let&rsquo;s Flash!</h3>
<ol>
<li>Format your USB stick to FAT32 <em>(no you <strong>don&rsquo;t</strong> need a bootable disk, just standard FAT32)</em></li>
<li>Download EFI Shell: <a href="https://github.com/pbatard/UEFI-Shell" target="_blank" rel="noopener">https://github.com/pbatard/UEFI-Shell</a>
 <em>(click on Releases and download the ISO)</em>
<ol>
<li>Extract the ISO</li>
<li>Make an <code>efi/boot</code> directory structure on your USB stick</li>
<li>Copy <code>bootx64.efi</code> from the ISO to <code>/efi/boot/</code> on the USB stick</li>
</ol>
</li>
<li>Download sas3flash.efi (or sas2flash.efi if you&rsquo;re flashing a 92xx card):
<a href="https://www.broadcom.com/support/knowledgebase/1211161501344/flashing-firmware-and-bios-on-lsi-sas-hbas" target="_blank" rel="noopener">https://www.broadcom.com/support/knowledgebase/1211161501344/flashing-firmware-and-bios-on-lsi-sas-hbas</a>
 <em>(very bottom of the page, note we want the EFI version)</em>
<ol>
<li>Copy <code>sas3flash.efi</code> to the root directory of your USB stick</li>
</ol>
</li>
<li>Acquire firmware - you can probably find this on Broadcom&rsquo;s site, after much googling and reading the TrueNAS forums for the right link for your card. Or use the
version from <a href="https://www.truenas.com/community/resources/lsi-9300-xx-firmware-update.145/" target="_blank" rel="noopener">https://www.truenas.com/community/resources/lsi-9300-xx-firmware-update.145/</a>
 if you&rsquo;ve got a 9300-xx card.
<ol>
<li>Copy <code>SAS9300_8i_IT.bin</code> <em>(find the file that matches the chip on your card)</em> to the root directory of your USB stick</li>
</ol>
</li>
<li>Disable secure boot in your BIOS <em>(on my ASUS mb, this required getting into the Advanced settings)</em></li>
<li>Boot your USB stick</li>
</ol>
<p>Now you&rsquo;re in an EFI shell! If it&rsquo;s your first time, yes, I agree, it does look like an OS from the 80s.</p>
<p>Here are the commands I used to flash my firmware:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">fs0:
</span></span><span class="line"><span class="cl">sas3flash.efi -listall
</span></span><span class="line"><span class="cl">sas3flash.efi -c <span class="m">0</span> -list
</span></span><span class="line"><span class="cl">sas3flash.efi -c <span class="m">0</span> -f FILENAME
</span></span><span class="line"><span class="cl">sas3flash.efi -c <span class="m">0</span> -list 
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li><code>fs0:</code> - this is us just changing &ldquo;directories&rdquo; to get to our USB stick root <em>(the 0 may vary if you&rsquo;ve got multiple USB drives plugged in)</em></li>
<li><code>sas3flash.efi -listall</code> - you&rsquo;re going to want to see your HBA show up here, if it doesn&rsquo;t there&rsquo;s no point in proceeding</li>
<li><code>sas3flash.efi -c 0 -list</code> - I assume that, like me, there&rsquo;s only one HBA in your system, so we reference it as <code>0</code>
<ol>
<li>This&rsquo;ll show you what firmware you&rsquo;ve currently got, as well as the mode (IR or IT) your HBA is in</li>
<li>While you&rsquo;re here, write down your SAS address, it may come in handy</li>
</ol>
</li>
<li><code>sas3flash.efi -c 0 -f FILENAME</code>
<ol>
<li>This is where the magic happens, in my case FILENAME was <code>SAS9300_8i_IT.bin</code></li>
</ol>
</li>
<li><code>sas3flash.efi -c 0 -list</code> - Confirmation: check that your firmware version is what you want it to be, and that you&rsquo;re in IT mode</li>
</ol>
<h2 id="additional-thoughts">Additional Thoughts</h2>
<p>These cards are designed for server chassis running in racks in datacenters. I.e., lots and lots of airflow: fans so loud that you&rsquo;d
never allow them in your house. So they&rsquo;ve got heatsinks but no fans on the cards, I&rsquo;ve rigged a <a href="https://amzn.to/3If9J1I" target="_blank" rel="noopener">40mm fan</a>
 to mine,
I recommend you do the same.</p>
]]></content:encoded></item><item><title>Github Pages and Hugo</title><link>https://vjarnot.github.io/posts/2023-02-10-github-pages-and-hugo-bootstrap/</link><pubDate>Fri, 10 Feb 2023 00:00:00 +0000</pubDate><guid>https://vjarnot.github.io/posts/2023-02-10-github-pages-and-hugo-bootstrap/</guid><description>These are the steps I followed to get a basic almost-zero-effort blog published to Github Pages. Adding posts simply requires creating/committing/pushing a new markdown file to your github repo - building the site and publishing it are completely automated.</description><content:encoded><![CDATA[<h2 id="extremely-basic-hugo--github-pages-step-by-step-guide">Extremely-basic Hugo + Github Pages Step-by-step Guide</h2>
<h3 id="background">Background</h3>
<ul>
<li><a href="https://pages.github.com/" target="_blank" rel="noopener">https://pages.github.com/</a>
</li>
<li><a href="https://gohugo.io/getting-started/quick-start/" target="_blank" rel="noopener">https://gohugo.io/getting-started/quick-start/</a>
</li>
</ul>
<h3 id="setup">Setup</h3>
<p>I mostly followed the steps outlined here <a href="https://gohugo.io/hosting-and-deployment/hosting-on-github/" target="_blank" rel="noopener">https://gohugo.io/hosting-and-deployment/hosting-on-github/</a>
 with some minor changes.</p>
<p>Here&rsquo;s what I did (this assumes you have a linux environment you&rsquo;re going to work in, and a github account):</p>
<h4 id="foundation">Foundation</h4>
<ol>
<li>Create repo for your github pages site
<ul>
<li>If you want your site available at <code>USERNAME.github.io</code>, the repo
<a href="https://docs.github.com/en/pages/getting-started-with-github-pages/about-github-pages#types-of-github-pages-sites" target="_blank" rel="noopener"><strong>must be named</strong></a>
 <code>USERNAME.github.io</code></li>
</ul>
</li>
<li>Clone the repo:
<ul>
<li><code>git clone https://github.com/USERNAME/USERNAME.github.io</code></li>
</ul>
</li>
<li>Install Hugo
<ul>
<li>on my Ubuntu instance, this was a simple <code>sudo apt install hugo</code></li>
</ul>
</li>
</ol>
<h4 id="create-site">Create Site</h4>
<p>Generate your site <em>(adapted from <a href="https://gohugo.io/getting-started/quick-start/" target="_blank" rel="noopener">https://gohugo.io/getting-started/quick-start/</a>
)</em></p>
<p><em>This assumes that you did the <code>git clone</code> from ~/projects and you&rsquo;re still in ~/projects</em></p>
<ol>
<li><code>hugo new site USERNAME.github.io --force</code>
<ul>
<li><code>--force</code> is here because the <code>USERNAME.github.io</code> directory already exists</li>
</ul>
</li>
<li><code>cd USERNAME.github.io</code></li>
<li>Install a theme
<ul>
<li><code>git submodule add https://github.com/theNewDynamic/gohugo-theme-ananke themes/ananke</code></li>
</ul>
</li>
<li>Create a hello-world blog post
<ul>
<li><code>hugo new posts/hello-world.md</code></li>
</ul>
</li>
<li>Edit hello-world.md and remove <code>draft: true</code></li>
<li>Test site
<ul>
<li>run <code>hugo server</code></li>
<li>open localhost:1313 in a browser</li>
</ul>
</li>
</ol>
<h4 id="github-pages-integration">Github Pages Integration</h4>
<p><em>NOTE: this assumes you want your site available at <code>USERNAME.github.io</code> - github expects those type of github pages to be published from the main branch.
However, we&rsquo;re going to deviate and commit our source to the <code>main</code> branch, while publishing from the <code>gh-pages</code> branch</em></p>
<p>First create a <code>gh-pages</code> branch in your repo on github. You&rsquo;ll never need to check out this branch - all your work will be done in <code>main</code>,
but the Github action we create below will build your site and commit it to <code>gh-pages</code> and Github will be configured to publish from <code>gh-pages</code>.</p>
<p>These steps are adapted from <a href="https://gohugo.io/hosting-and-deployment/hosting-on-github/" target="_blank" rel="noopener">https://gohugo.io/hosting-and-deployment/hosting-on-github/</a>
</p>
<ol>
<li><code>mkdir -p .github/workflows</code> in your project root (in the example used throughout, that would be <code>~/projects/USERNAME.github.io</code>)</li>
<li>create <code>.github/workflows/gh-pages.yml</code>:
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">github pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">main </span><span class="w"> </span><span class="c"># Set a branch that will trigger a deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">deploy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">permissions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l">write</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-22.04</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">submodules</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">  </span><span class="c"># Fetch Hugo themes (true OR recursive)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">fetch-depth</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">    </span><span class="c"># Fetch all history for .GitInfo and .Lastmod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Setup Hugo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-hugo@v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">hugo-version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;latest&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="c"># extended: true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">hugo --minify</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Deploy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-gh-pages@v3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l">github.ref == &#39;refs/heads/main&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">github_token</span><span class="p">:</span><span class="w"> </span><span class="l">${{ secrets.GITHUB_TOKEN }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">publish_dir</span><span class="p">:</span><span class="w"> </span><span class="l">./public</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><em><strong>You can find this yaml in the Hugo Docs, but I had to add lines 10-11 to get this working.</strong></em></li>
<li>Remember how I mentioned that github pages wants to publish from your <code>main</code> branch? Let&rsquo;s change that:
<ul>
<li>On your github repo, click Settings, then Pages</li>
<li>Under Build and Deployment, select <code>gh-pages</code></li>
</ul>
</li>
</ol>
<h4 id="success-success">Success? Success!</h4>
<p>What you should have now is a very simple and streamlined workflow:</p>
<ol>
<li>You checkout, edit, commit, and push to the <code>main</code> branch</li>
<li>Your github action executes on push, generates your site, and commits that output to the <code>gh-pages</code> branch</li>
<li>Github sees the commit to <code>gh-pages</code> and publishes your site</li>
</ol>
<h3 id="troubleshooting">Troubleshooting</h3>
<p>Check the <code>Actions</code> tab on your Github repo - you should see an action with the same name as your commit comment - this is running the workflow we defined above.
If that&rsquo;s erroring, you should probably fix it ;) Subsequent to that you should see Github&rsquo;s <code>pages build and deployment</code> action - that&rsquo;s the Github Pages magic that actually publishes your site.</p>
<!-- ### Setup

I mostly followed the steps outlined here https://gohugo.io/hosting-and-deployment/hosting-on-github/ with some minor changes.

Here's what I did - this assumes you have a linux environment you're going to work in, and a github account:

1. Create repo for your github pages site
    * If you want your site available at `USERNAME.github.io`, ensure the repo is named `USERNAME.github.io`
2. Clone the repo:
    * `git clone https://github.com/USERNAME/USERNAME.github.io`
3. Install Hugo
    * on my Ubuntu instance, this was a simple `apt install hugo`
4. Generate site (adapted from https://gohugo.io/getting-started/quick-start/ )
    * Assuming you did the `git clone` from ~/projects and you're still in ~/projects
        1. `hugo new site USERNAME.github.io --force`
            * `--force` is here because the `USERNAME.github.io` directory already exists
        2. `cd USERNAME.github.io`
        3. Install a theme
            * `git submodule add https://github.com/theNewDynamic/gohugo-theme-ananke themes/ananke`
        4. Create a hello-world blog post
            * `hugo new posts/hello-world.md`
        5. Edit hello-world.md and remove `draft: true`
        6. Test site
            * run `hugo server`
            * open localhost:1313 in a browser
5. Create a `gh-pages` branch in your repo on github
6. Set up Github actions to auto-publish your site (adapted from https://gohugo.io/hosting-and-deployment/hosting-on-github/ )
    * NOTE: this assumes you want your site available at `USERNAME.github.io` - github expects those type of github pages to be published from the main branch.
    However, we're going to deviate and commit our source to the `main` branch, while publishing from the `gh-pages` branch
    * in ~/projects/USERNAME.github.io
        1. `mkdir -p .github/workflows`
        2. create `.github/workflows/gh-pages.yml`:
            ```yaml
            name: github pages
            on:
              push:
                branches:
                  - main  # Set a branch that will trigger a deployment
              pull_request:

            jobs:
              deploy:
                permissions:
                  contents: write
                runs-on: ubuntu-22.04
                steps:
                  - uses: actions/checkout@v3
                    with:
                      submodules: true  # Fetch Hugo themes (true OR recursive)
                      fetch-depth: 0    # Fetch all history for .GitInfo and .Lastmod

                  - name: Setup Hugo
                    uses: peaceiris/actions-hugo@v2
                    with:
                      hugo-version: 'latest'
                      # extended: true

                  - name: Build
                    run: hugo --minify

                  - name: Deploy
                    uses: peaceiris/actions-gh-pages@v3
                    if: github.ref == 'refs/heads/main'
                    with:
                      github_token: ${{ secrets.GITHUB_TOKEN }}
                      publish_dir: ./public
            ```
        ***You can find this yaml in the Hugo Docs, but I had to add lines 10-11 to get this working.***
7. Remember how I mentioned that github pages wants to publish from your `main` branch? Let's change that:
    * On your github repo, click Settings, then Pages
    * Under Build and Deployment, select `gh-pages`
8. Success?
    * What you should have now is the following setup:
        1. You checkout, edit, commit, and push to `main`
        2. Your github action executes on push, generates your site, and commits that output to `gh-pages`
        3. Github sees the commit to `gh-pages` and publishes your site

### Troubleshooting

Check the `Actions` tab on your Github repo - you should see an action with the same name as your commit comment - this is running the workflow we defined above.
If that's erroring, you should probably fix it ;) Subsequent to that you should see Github's `pages build and deployment` action - that's the Github Pages magic that actually publishes your site.

 -->]]></content:encoded></item></channel></rss>